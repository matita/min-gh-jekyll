---
title: "Creating a Donation Widget with Flight Components"
description: "Niels Klomb walks through the process of creating a donation widget with Flight, creating a reusable component that connect to the Stripe API."
link: "http://www.sitepoint.com/creating-donation-widget-with-flight-components/"
saved: "2016-04-01 10:59:51"
---

    <p><em>This article was peer reviewed by <a href="http://www.sitepoint.com/author/tgreco/">Tom Greco</a>. Thanks to all of SitePoint’s peer reviewers for making SitePoint content the best it can be!</em></p>
<p>In this tutorial I will be teaching you the basics of Twitter’s <a href="https://flightjs.github.io/">Flight.js</a> by making a donation widget, which also uses <a href="http://materializecss.com/">Materialize</a> for the front-end, and <a href="https://stripe.com/">Stripe</a> to handle the payments. We’ll be covering Flight’s main concepts and methods.</p>

<p>Flight is an event driven framework by Twitter. Based on components, Flight maps behaviors to DOM nodes independently. Unlike other popular frameworks, Flight doesn’t prescribe a particular approach to how you render or fetch your data it is, however, dependent on jQuery. In its essence, Flight is all about events. These can be triggered by the DOM or by artificial triggers within other UI components. Flight is basically a framework for making frameworks. This might sound complicated, but while Flight isn’t as 1-2-3 as jQuery, its learning curve is exaggerated and learning Flight could definitely improve your JavaScript skills. </p>
<h2 id="whyuseflight">Why Use Flight?</h2>
<ul>
<li>Write more readable jQuery.</li>
<li>Write re-useable components.</li>
<li>Use as much or as little of other libraries as you want.</li>
<li>A better structure for your code in general.</li>
<li>Supports and even prefers modular JS.</li>
</ul>
<h3 id="readabilityjqueryvsflight">Readability: jQuery vs Flight</h3>
<p>Let’s say we’re listening for a click and a hover on a button. Using jQuery you’d probably do something like this:</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'You clicked?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mouseover'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Oops'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>But using Flight this all goes into one component. </p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">var</span> Button <span class="token operator">=</span> flight<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>log <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Oops!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>confirm <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'You clicked?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token string">'initialize'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mouseover'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>confirm<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Button<span class="token punctuation">.</span><span class="token function">attachTo</span><span class="token punctuation">(</span><span class="token string">'#button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Of course, jQuery requires less code but, with Flight our code is structured a lot clearer. The events are two different threads in jQuery, but in Flight these are both contained within the same component. We can easily see that this component and the element it is attached to are listening for two events. But let’s say we wanted to add that <code class=" language-javascript">hover</code> event listener 200 lines later in our code. Using jQuery, you’d probably add it at that point in your file. However using Flight we are almost forced to add it to the existing component.  </p>
<p>I’ve made a template that includes everything you need to get started so you can get straight to coding. You can fork/download it from <a href="http://codepen.io/SitePoint/pen/BKKQqw">CodePen</a>. </p>
<p>Want to make your own template? Just copy in these CDN’s:</p>
<pre class=" language-markup"><code class="markup  language-markup"><span class="token script language-javascript"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://code.jquery.com/jquery-2.1.1.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>
<span class="token script language-javascript"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://flightjs.github.io/release/latest/flight.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>
<span class="token script language-javascript"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://checkout.stripe.com/checkout.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>    
</code></pre>
<h2 id="makingyourfirstcomponent">Making Your First Component</h2>
<p>Flight consists of ‘components’. Components are reusable blocks of code that stand alone within your application. Creating a component is a lot like creating an object constructor except that components cannot be changed or accessed after they have been initialized. Components can only communicate with your app through events. Either by triggering them, or listening to them.</p>
<p>Flight component’s can be as simple or as complex as you like. In the example below we are only listening for a hover (mouseover) event on a button, and showing an alert when that happens. </p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">var</span> Button <span class="token operator">=</span> flight<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>alert <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Oops!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token string">'initialize'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mouseover'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>alert<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Button<span class="token punctuation">.</span><span class="token function">attachTo</span><span class="token punctuation">(</span><span class="token string">'#button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>This is obviously nothing jQuery couldn’t do, and structuring your code like this may seem like a lot of effort now, but once you start using Flight for things other than hover events you will understand its benefits.<br>
As long as you understand that it’s listening for a <code class=" language-javascript">mouseover</code> event and triggering an inner function you’re fine for now. I’ll explain what the rest means later on in this tutorial.</p>
<h2 id="gettingstarted">Getting Started</h2>
<p>If you are using the template, the form in your <code class=" language-javascript">index<span class="token punctuation">.</span>html</code> file should look like this:</p>
<pre class=" language-markup"><code class="markup  language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>accept<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>accept<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>By proceeding your agree to our terms, which are completely unfair and well, not very real.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>waves-effect btn<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>launch<span class="token punctuation">"</span></span> <span class="token attr-name">disabled</span><span class="token punctuation">&gt;</span></span>Let's Go<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>We want to enable the button when the check-box has been checked and disable it otherwise. Let’s head over to our JavaScript code and create our first component. </p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">var</span> checkToEnable <span class="token operator">=</span> flight<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// Magic</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Each Flight component consists of a few different methods. Some of these are required, others are not. The first method we’ll be adding is <a href="https://github.com/flightjs/flight/blob/v1.x/doc/base_api.md#this.attributes">attributes()</a>. The <code class=" language-javascript"><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code> method contains one or more  attributes. Attributes are scoped variables and / or arguments. Empty attributes (ones declared with a value of <code class=" language-javascript"><span class="token keyword">null</span></code>),  require a value to be passed to them when the component is initialized. Other attributes will use their default values unless instructed otherwise. Attributes are typically used to hold element references. Insert the following code into your component:</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    button<span class="token punctuation">:</span> <span class="token keyword">null</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The button <code class=" language-javascript">attribute</code> will serve as a reference to the button we want to enable. The next method we want to add is the <a href="https://github.com/flightjs/flight/blob/v1.x/doc/base_api.md#this.initialize">initialize()</a> method.</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token string">'initialize'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>enableButton<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Flight components already define a default implementation of <code class=" language-javascript"><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code> which we want to extend rather than overwrite, which is why we’re using the <a href="https://github.com/flightjs/flight/blob/v1.x/doc/advice_api.md#thisafterexistingfuncname-customfunc">after()</a> method here. Inside of the callback function we’ve added an <a href="https://github.com/flightjs/flight/blob/v1.x/doc/base_api.md#this.on">event listener</a>. This will listen for a change on the element which the component will be attached to and consequently trigger the <code class=" language-javascript"><span class="token function">enableButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code> function, which we’ll create next.</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span>enableButton <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> buttonEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>attr<span class="token punctuation">.</span>button<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>checked<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token keyword">true</span><span class="token punctuation">:</span>
            buttonEl<span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token keyword">false</span><span class="token punctuation">:</span> 
            buttonEl<span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>This doesn’t do anything too fancy. It’s just a simple function which enables the button when the checkbox, which this component will be attached to, is checked and vice versa. You may have noticed that we accessed the <code class=" language-javascript">attribute</code> by calling this.attr. This is bad practice and I will show you a better solution later on.</p>
<p>Our component isn’t working just yet. To complete it we need to attach it to the DOM. This happens ‘outside’ of the component. A component can be attached to as many elements as you like, it can also be attached to the document, but the component has to come first. We will pass in the reference to the button element as an argument.</p>
<pre class=" language-javascript"><code class="javascript  language-javascript">checkToEnable<span class="token punctuation">.</span><span class="token function">attachTo</span><span class="token punctuation">(</span><span class="token string">'#accept'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    button<span class="token punctuation">:</span> <span class="token string">'launch'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Great! You’ve created your first Flight component. To recap, it should be looking like this: </p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">var</span> checkToEnable <span class="token operator">=</span> flight<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        button<span class="token punctuation">:</span> <span class="token keyword">null</span> 
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>enableButton <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> buttonEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>attr<span class="token punctuation">.</span>button<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>checked<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token keyword">true</span><span class="token punctuation">:</span>
                document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>attr<span class="token punctuation">.</span>button<span class="token punctuation">)</span><span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token keyword">false</span><span class="token punctuation">:</span> 
                document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>attr<span class="token punctuation">.</span>button<span class="token punctuation">)</span><span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token string">'initialize'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>enableButton<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="divingin">Diving In</h2>
<p>By now you should understand the three most important concepts: attributes, callback functions, and <code class=" language-javascript"><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code>. Most Flight components consist of just these parts. Our next one is going to use a core concept of Flight: event bubbling. Event bubbling sounds a little complicated, but it’s actually not that hard to understand. For example, let’s say I have a <code class=" language-javascript">button</code> and its parent is a <code class=" language-javascript">div</code>. When the <code class=" language-javascript">button</code> is clicked its event will bubble up to the <code class=" language-javascript">div</code>, assuming our component is attached to the <code class=" language-javascript">div</code>.</p>
<p>This is exactly how our next component will work. It will be attached to the donation widget, in the form of a Materialize modal, but we’ll be listening for events from its children. First things first, we need to add the markup for the modal into our <code class=" language-javascript">index<span class="token punctuation">.</span>html</code> file.  Insert it before the closing body tag:</p>
<pre class=" language-markup"><code class="markup  language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stripe-widget<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>modal-content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span><span class="token punctuation">&gt;</span></span>Give us your money.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>We'll use it well, we promise.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>range-field<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>range<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stripe-amount<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>modal-footer<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn blue waves-effect waves-blue<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkout<span class="token punctuation">"</span></span> <span class="token attr-name">disabled</span><span class="token punctuation">&gt;</span></span>Donate <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">data-amount</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fa fa-cc-stripe<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#!<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span> modal-action modal-close waves-effect waves-red btn-flat<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Close<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>Now let’s create our component.</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">var</span> getAmount <span class="token operator">=</span> flight<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// Magic</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>To better understand our component we’ll be adding its methods in reverse order. First of all add the <code class=" language-javascript">initialize</code> method.</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token string">'initialize'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>attr<span class="token punctuation">.</span>range<span class="token punctuation">,</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onChange<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>attr<span class="token punctuation">.</span>checkout<span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onClick<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Looks different doesn’t it? Because our component is attached to the donation widget we’re passing in two of its children within our event listeners. This might not make sense now but it soon will. Let’s add the attributes.</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    checkout<span class="token punctuation">:</span> <span class="token string">'#checkout'</span><span class="token punctuation">,</span>
    range<span class="token punctuation">:</span> <span class="token string">'#stripe-amount'</span><span class="token punctuation">,</span>
    display_amount<span class="token punctuation">:</span> <span class="token string">'[data-amount]'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre>
<p>These attributes work with the current markup. You might add this component to some different markup in the future, in which case you can pass in different selectors. Next up we’ll be adding the <code class=" language-javascript"><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code> function.</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span>onChange <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> amount <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'range'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>amount <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'please enter an amount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'checkout'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'disabled'</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'checkout'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'disabled'</span><span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'display_amount'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'$'</span> <span class="token operator">+</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'checkout'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'data-stripe-amount'</span><span class="token punctuation">,</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>The one method that stands out is <a href="https://github.com/flightjs/flight/blob/v1.x/doc/base_api.md#this.select">select()</a>, which is a lot like jQuery’s find method, but its scope only includes children of the attached element (the donation widget). The important thing to understand is that we’re referencing our attribute names as strings. This confused me to at first, so just keep this in mind, because this is actually one of the shortcuts Flight has created.</p>
<p>Since the button has been enabled it can now listen for events. Let’s add the <code class=" language-javascript"><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code> function now.</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span>onClick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> stripeAmount <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'checkout'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'data-stripe-amount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stripeAmount <span class="token operator">=</span> stripeAmount <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'callStripe'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        amount<span class="token punctuation">:</span> stripeAmount
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>First of all we’re fetching the amount from an attribute of the button, then we’re making it valid for Stripe by adding two zeros. That’s nothing new though. The real magic is happening in the <a href="https://github.com/flightjs/flight/blob/v1.x/doc/base_api.md#this.trigger">trigger method</a>, which is triggering a custom event and passing along the amount as data (also known as the payload). We’re going to create the component which will listen for that event next. The finished component should look like this:</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">var</span> getAmount <span class="token operator">=</span> flight<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        checkout<span class="token punctuation">:</span> <span class="token string">'#checkout'</span><span class="token punctuation">,</span>
        range<span class="token punctuation">:</span> <span class="token string">'#stripe-amount'</span><span class="token punctuation">,</span>
        display_amount<span class="token punctuation">:</span> <span class="token string">'[data-amount]'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>onChange <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> amount <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'range'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>amount <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'please enter an amount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'checkout'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'disabled'</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'checkout'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'disabled'</span><span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'display_amount'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'$'</span> <span class="token operator">+</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'checkout'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'data-stripe-amount'</span><span class="token punctuation">,</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>onClick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> stripeAmount <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'checkout'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'data-stripe-amount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stripeAmount <span class="token operator">=</span> stripeAmount <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'callStripe'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            amount<span class="token punctuation">:</span> stripeAmount
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token string">'initialize'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>attr<span class="token punctuation">.</span>range<span class="token punctuation">,</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onChange<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>attr<span class="token punctuation">.</span>checkout<span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onClick<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Before we create the final component we have to <code class=" language-javascript">initialize</code> the previous one. Because the modal itself is initialized dynamically, we’ll attach it after it has been initialized. The code below is just a simple click event listener for the button we enabled in the first component, after which we attach our new component. The <code class=" language-javascript"><span class="token function">openModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code> method belongs to Materialize.</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#launch'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#stripe-widget'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">openModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    getAmount<span class="token punctuation">.</span><span class="token function">attachTo</span><span class="token punctuation">(</span><span class="token string">'#stripe-widget'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="meetstripe">Meet Stripe</h2>
<p>In a nutshell, Stripe is the PayPal you always imagined, made with developers in mind. Stripe is used in many websites and apps to handle payments (Twitter and Kickstarter, to name a few). They offer a range of services or APIs (whatever you want to call them), but the one we’re going to use is <a href="https://stripe.com/checkout">Checkout</a>.  </p>
<p>After Stripe has verified someone’s credit card your website will receive a token back, this token then needs to be sent to Stripe along with your secret key. Since your key is secret this can’t happen on the front-end, because JavaScript wasn’t and isn’t meant to be, at least in its original form,  secure. To do this you can use one of Stripe’s libraries for <a href="https://stripe.com/docs/checkout/guides/php">PHP</a>, <a href="https://stripe.com/docs/checkout/guides/sinatra">Sinatra</a>, <a href="https://stripe.com/docs/checkout/guides/flask">Python (Flask)</a>, <a href="https://stripe.com/docs/checkout/guides/rails">Rails</a> or <a href="https://stripe.com/docs/api/node#intro">Node.js</a>.</p>
<p>I mentioned keys right? Well, to get a key you need to <a href="https://stripe.com/">sign up</a> for a free Stripe account. You don’t even need a credit card yourself, a plain old bank account will do! After you get your own key you will have to replace my public key with yours when calling Stripe (as shown below). They offer ‘test’ and ‘real’ keys so you easily test your application with little effort. When using test keys, Stripe will also accept test credit cards.</p>
<p>Everything should be working up to the point where you click on the donate button, and nothing happens. Let’s add the last bit of magic.</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">var</span> launchStripe <span class="token operator">=</span> flight<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// Magic</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>This component will launch Stripe for us. In order to do this we first have to create a Stripe instance at the top of our document (not within a component).</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">var</span> handler <span class="token operator">=</span> StripeCheckout<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    key<span class="token punctuation">:</span> <span class="token string">'pk_test_hue7wHe5ri0xzDRsBSZ9IBEC'</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//replace this with your key!</span>
    image<span class="token punctuation">:</span> <span class="token string">'http://freedesignfile.com/upload/2014/06/Cup-of-coffee-design-vector-material-03.jpg'</span><span class="token punctuation">,</span>
    locale<span class="token punctuation">:</span> <span class="token string">'auto'</span><span class="token punctuation">,</span>
    token<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token string">'Thank you! &lt;i class="fa fa-beer"&gt;&lt;/i&gt;'</span><span class="token punctuation">;</span>
        Materialize<span class="token punctuation">.</span><span class="token function">toast</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// Send to server</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>While getting into the back-end side of things is a bit beyond the scope of this article, as mentioned above, Stripe has a Node.js library that might be a bit less intimidating for those comfortable with JavaScript. You can send your key to a Node server via a HTTP request using a module like <a href="http://expressjs.com/">Express</a>. Within your Node server’s response to that request, you would do something like this:</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">var</span> stripe <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"stripe"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>
  <span class="token string">"sk_test_yourkeyhere"</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

stripe<span class="token punctuation">.</span>customers<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  description<span class="token punctuation">:</span> <span class="token string">'Coffeehouse Customer'</span><span class="token punctuation">,</span>
  source<span class="token punctuation">:</span> <span class="token string">"tok_yourtoken"</span> <span class="token comment" spellcheck="true">// This comes from our front end JavaScript code</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> customer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// asynchronously called</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>If you’d like a more complete example of using Stripe and Node.js, the SitePoint article on <a href="http://www.sitepoint.com/how-to-build-a-daily-affirmations-sms-service-with-stripe-syncano/">Building a Daily Affirmations SMS Service with Stripe &amp; Syncano</a> covers the Node.js side of the process in more detail and even shows how you can use a microservice platform like Syncano to run the Node.js code for you from the backend.</p>
<p>Now let’s get back to our component. We are going to add the <code class=" language-javascript">initialize</code> method first and make it listen for the event we triggered in our second component.</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token string">'initialize'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'callStripe'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>launch<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>We’re basically listening for a custom, internally triggered, event rather than a DOM event. All we have to do now is create the callback, which will launch Stripe.</p>
<pre class=" language-javascript"><code class="javascript  language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span>launch <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>event<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#stripe-widget'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">closeModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    handler<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">'the Coffeehouse'</span><span class="token punctuation">,</span>
        description<span class="token punctuation">:</span> <span class="token string">'Thank You!'</span><span class="token punctuation">,</span>
        currency<span class="token punctuation">:</span> <span class="token string">"usd"</span><span class="token punctuation">,</span>
        amount<span class="token punctuation">:</span> data<span class="token punctuation">.</span>amount
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>Our function is expecting two arguments, the event and the data. The event is the same as usual but the data includes the payload we included upon initially triggering the event in the previous component. The payload is simply our amount, because that’s all we added to the event. But in more complex cases this could be a full response from an API call. </p>
<p>The other thing we’re doing is launching Stripe’s payment form using the amount we got from the previous component. You can find the full Checkout documentation <a href="https://stripe.com/docs/checkout">here</a>.</p>
<p>Finally we need to initialize the last component. Instead of attaching it to a specific element we’re hooking it up to the document.</p>
<pre class=" language-javascript"><code class="javascript  language-javascript">launchStripe<span class="token punctuation">.</span><span class="token function">attachTo</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Our finished code should look something like <a href="http://www.nielsklom.eu/flight_demo/">this</a>. We’ve done quite a lot in less than 100 lines of JavaScript!</p>
<h2 id="conclusion">Conclusion</h2>
<p>Hopefully Flight makes a little sense by now, but whatever the case may be you can find the full documentation <a href="https://github.com/flightjs/flight/blob/v1.x/doc/README.md">here</a>. As you can see, Flight’s component system results in extremely readable and modular code. For example you could reuse the <code class=" language-javascript">launchStripe</code> component anytime you wanted to process a payment, or reuse the <code class=" language-javascript">enableButton</code> component anytime you wanted a checkbox to be checked before enabling a button. Flight is great like this, and because it doesn’t prescribe a particular approach the possibilities are endless.</p>
<p>If you’ve built something interesting with Flight, or you just want to share your thoughts about it, please comment down below!</p>
  