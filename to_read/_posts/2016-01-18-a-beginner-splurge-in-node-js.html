---
title: "A Beginner Splurge in Node.js"
description: "Camilo Reyes plays with Node.js and the CLI. In this article you'll play with callbacks, I/O operations, and a web server."
link: "http://www.sitepoint.com/a-beginner-splurge-in-node-js/"
saved: "2016-01-18 12:50:03"
---

    <p><em>This article was peer reviewed by <a href="http://www.sitepoint.com/author/rkiran/">Rabi Kiran</a>. Thanks to all of SitePoint’s peer reviewers for making SitePoint content the best it can be!</em></p>
<p>It’s 3 a.m., hands over the keyboard while staring at an empty console. The bright prompt over a dark backdrop ready, yearning to take in commands. Want to hack up Node.js for a little while? One of the exciting news about Node.js is that it runs anywhere. This opens up the stack to various ways to experiment with it. For any seasoned veteran, this is a fun run of the command line tooling. What I like the most is that we can survey the stack from within the safety net of the command line. The cool thing is that we are still talking about JavaScript, hence most of you should not have any problem. So, why not fire up <code class=" language-undefined">node</code> up in the console?</p>
<p>In this article, I’ll introduce you to Node.js. My goal is to go over the main highlights while hiking up some pretty high ground. This is an intermediate overview of the stack while keeping it all inside the console. If you want a beginner-friendly guide about Node.js, I suggest you to watch the SitePoint premium’s course <a href="https://www.sitepoint.com/premium/courses/node-js-an-introduction-2866">Node.js: An Introduction</a>.</p>
<p><img src="http://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2015/10/1446316790Node.js-in-the-Windows-console.jpg" alt="Node.js in the Windows console" width="356" height="208" class="aligncenter size-full wp-image-118214"></p>
<h2 id="why-nodejs">Why Node.js?</h2>
<p>Before we begin, let’s go over the tidbits that make Node.js stand out from the crowd.</p>
<ul>
<li>It’s designed for non-blocking I/O</li>
<li>It’s designed for asynchronous operations</li>
<li>It runs Chrome’s V8 JavaScript</li>
</ul>
<p>You may have heard these points through many sources, but what does it all mean? You can think of Node.js as the engine that exposes many APIs to the JavaScript language. In traditional computing where processes are synchronous, when you perform any I/O operation, the API waits before it runs the next line of code. An I/O operation is, for example, reading a file or making a network call. Node.js doesn’t do that and it’s designed from the beginning to have asynchronous operations. In today’s computing market, this has a tremendous advantage. Can you think of the last time you bought a new computer because it had a faster single processor? The number of cores and a faster hard-drive is more important.</p>
<div class="ArticleBox u-inline"><h3 class="ArticleBox_header t-bg">
                    <span class="ArticleBox_icon fa fa-pencil"></span> More from this author
                 </h3><div class="ArticleBox_content"><ul class="ArticleBox_list t-list"><li><a href="http://www.sitepoint.com/guide-vanilla-ajax-without-jquery/?utm_source=sitepoint&amp;utm_medium=relatedinline&amp;utm_term=javascript&amp;utm_campaign=relatedauthor">A Guide to Vanilla Ajax Without jQuery</a></li><li><a href="http://www.sitepoint.com/art-saying/?utm_source=sitepoint&amp;utm_medium=relatedinline&amp;utm_term=javascript&amp;utm_campaign=relatedauthor">The Art of Saying "No"</a></li></ul></div></div>
<p>In the remainder of the article, when you see a <code class=" language-undefined">&gt;</code>, which is a prompt symbol, this means hit <code class=" language-undefined">Enter</code> to type up the next command. Moreover, before running the code in this article you have to open the CLI and execute the command <code class=" language-undefined">node</code>. With that said, let’s begin our tour!</p>
<h2 id="callbacks">Callbacks</h2>
<p>To start, type up this function:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token operator">&gt;</span> <span class="token keyword">function</span> add<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span> var result <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> callback<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre>
<p>To a newbie, a callback in JavaScript may seem strange. It certainly doesn’t look like any classical OOP approach. In JavaScript, functions are objects and objects can take in other objects as parameters. JavaScript doesn’t care what an object has, so it follows that a function can take in an object that happens to be yet another function. The arity, which is the number of parameters, goes from two in <code class=" language-undefined">add()</code> to a single parameter in the callback. This system of callbacks is powerful since it enables encapsulation and implementation hiding. In Node.js, you’ll find a lot of APIs that take in a callback as a parameter. One way to think about callbacks is as a delegate. Programming lingo aside, a delegate is a person sent and authorized to represent others. So a callback is like sending someone to run an errand. Given a list of parameters, like a grocery list for example, they can go and do a task on their own.</p>
<p>To play around with <code class=" language-undefined">add</code>:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token operator">&gt;</span> add<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">'2 + 3 = '</span> <span class="token operator">+</span> c<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">'Is 1 + 1 = 3? '</span> <span class="token operator">+</span> <span class="token punctuation">(</span>c <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Feel free to make up more creative ways to play around with callbacks. Callbacks are the building block for some important APIs in Node.js.</p>
<h2 id="asynchronous-operations">Asynchronous Operations</h2>
<p>With callbacks, we are able to start building asynchronous APIs. For example:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token operator">&gt;</span> <span class="token keyword">function</span> doSomething <span class="token punctuation">(</span>asyncCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span> asyncCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> doSomething<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">'This runs synchronously.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>This particular example has a synchronous execution. But, we have everything we need for asynchrony in JavaScript. The <code class=" language-undefined">asyncCallback</code>, for example, can get delayed in the same thread:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token operator">&gt;</span> <span class="token keyword">function</span> doSomething <span class="token punctuation">(</span>asyncCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span> setTimeout<span class="token punctuation">(</span>asyncCallback<span class="token punctuation">,</span> Math<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> doSomething<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">'This runs asynchronously.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> console<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>I use a <code class=" language-undefined">setTimeout</code> to delay execution in the current thread. Timeouts do not guarantee time of execution. I placed a <code class=" language-undefined">Math.random()</code> to make it even more fickle. I call <code class=" language-undefined">doSomething()</code>, followed up with a <code class=" language-undefined">console.log('test')</code> to display delayed execution. You will experience a short delay between one to two seconds, then see a message pop up on the screen. What I illustrate is that asynchronous callbacks are unpredictable. Node.js places this callback in a scheduler and continues on its merry way. When the timer fires, Node.js picks up right where execution happens to be and calls the callback. So, you must wrap your mind around petulant callbacks to understand Node.js. </p>
<p>In short, callbacks are not always what they seem in JavaScript.</p>
<p>Let’s go on with something cooler. How about a simple DNS lookup in Node.js?</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token operator">&gt;</span> dns<span class="token punctuation">.</span>lookup<span class="token punctuation">(</span><span class="token string">'bing.com'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> address<span class="token punctuation">,</span> family<span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">' Address: '</span> <span class="token operator">+</span> address <span class="token operator">+</span> <span class="token string">', Family: '</span>  <span class="token operator">+</span> family <span class="token operator">+</span> <span class="token string">', Err: '</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The callback returns <code class=" language-undefined">err</code>, <code class=" language-undefined">address</code>, and <code class=" language-undefined">family</code> objects. What is important is that return values get passed in as parameters to the callback. So this is not like your traditional API of <code class=" language-undefined">var result = fn('bing.com');</code>. In Node.js, you must get callbacks and asynchrony to get the big picture. You are free to checkout the [DNS Node.js API][2] for more specifics. This is what the DNS lookup looks like in my console:</p>
<p><img src="http://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2015/10/1446316782Node.js-DNS-lookup.jpg" alt="Node.js DNS lookup" width="426" height="229" class="aligncenter size-full wp-image-118212"></p>
<h2 id="file-io">File I/O</h2>
<p>Now to pick up the pace, how about doing file I/O on Node.js? Imagine this scenario where you open a file, read it and then write content into it. In modern computer architecture, I/O bound operations lag. CPU registers are fast, the CPU cache is fast, RAM is fast. But, you go read and write to disk and it gets slow. So when a synchronous program performs I/O bound operations, it runs slowly. The better alternative is to do it asynchronous, as such:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token operator">&gt;</span> var fs <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> fs<span class="token punctuation">.</span>writeFile<span class="token punctuation">(</span><span class="token string">'message.txt'</span><span class="token punctuation">,</span> <span class="token string">'Hello Node.js'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">'Saved.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> console<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">'Writing file...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Due to the fact that the operation is asynchronous, you will see “Writing file…” before the file gets saved on disk. The natural use of callback functions fits well in this API. You can explore the [File System API][6] in the documentation. How about reading from this file? Can you guess off the top of your head how to do that in Node.js? I’ll give you a hint, the callback takes in <code class=" language-undefined">err</code> and <code class=" language-undefined">data</code>. I encourage you giving it a try.</p>
<p>Here is the answer:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token operator">&gt;</span> fs<span class="token punctuation">.</span>readFile<span class="token punctuation">(</span><span class="token string">'message.txt'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span>log<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>You may also pass in an <code class=" language-undefined">encoding</code> option to get the <code class=" language-undefined">utf-8</code> contents of the file:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token operator">&gt;</span> fs<span class="token punctuation">.</span>readFile<span class="token punctuation">(</span><span class="token string">'message.txt'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>encoding<span class="token punctuation">:</span> <span class="token string">'utf-8'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span>log<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The use of callback functions with async I/O looks nice in Node.js. The advantage here is we are leveraging a basic building block in JavaScript. Callbacks get lifted to a new level of pure awesomeness with asynchronous APIs that do not block.</p>
<h2 id="a-web-server">A Web Server</h2>
<p>So, how about a web server? Any good exposé of Node.js must run a web server. Imagine an API named <code class=" language-undefined">createServer</code> with a callback that takes in <code class=" language-undefined">request</code> and <code class=" language-undefined">response</code>. You can explore <a href="https://nodejs.org/api/http.html">the HTTP API</a> in the documentation. Can you think of what that looks like? You’ll need the <code class=" language-undefined">http</code> module. Go ahead and start typing in the console.</p>
<p>Here is the answer:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token operator">&gt;</span> var http <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> var server <span class="token operator">=</span> http<span class="token punctuation">.</span>createServer<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token punctuation">{</span> response<span class="token punctuation">.</span>end<span class="token punctuation">(</span><span class="token string">'Hello Node.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>When you think of the web, it is a client-server model of requests and responses. Node.js has a <code class=" language-undefined">request</code> object that comes from the client and a <code class=" language-undefined">response</code> object from the server. So the stack embraces the crux of the web with this simple callback mechanism. Do I need to remind you that it is asynchronous? I hope the pieces are coming together. If you look at the file API, what we are doing here is not so different. We bring in a module, tell it to do something and pass in a callback. The callback works like a delegate which does a specific task given a list of parameters.</p>
<p>Of course, everything is nonsense if we can’t it see it on a browser. To fix this type on the CLI:</p>
<pre class=" language-bash"><code class=" language-bash">server<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>And point your favorite browser to <code class=" language-undefined">localhost:8080</code>, which in my case was Edge.</p>
<p><img src="http://dab1nmslvvntp.cloudfront.net/wp-content/uploads/2015/10/1446316786Node.js-on-Microsoft-Edge.jpg" alt="Node.js on Microsoft Edge" width="304" height="146" class="aligncenter size-full wp-image-118213"></p>
<p>Imagine the <code class=" language-undefined">request</code> object as having a ton of information available to you. To rewire the <code class=" language-undefined">server</code>, let’s bring it down first:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token operator">&gt;</span> server<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span>createServer<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token punctuation">{</span> response<span class="token punctuation">.</span>end<span class="token punctuation">(</span>request<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'user-agent'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> server<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">8081</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Point the browser to <code class=" language-undefined">localhost:8081</code>. The <code class=" language-undefined">headers</code> object gives you <code class=" language-undefined">user-agent</code> information which comes from the browser. We can also loop through the <code class=" language-undefined">headers</code> object:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token operator">&gt;</span> server<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span>createServer<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token punctuation">{</span> Object<span class="token punctuation">.</span>keys<span class="token punctuation">(</span>request<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>forEach<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span> response<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> request<span class="token punctuation">.</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> response<span class="token punctuation">.</span>end<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> server<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">8082</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Point the browser to <code class=" language-undefined">localhost:8082</code> this time. Once finished playing around with your server, be sure to bring it down. The command line might start acting funny if you don’t.</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token operator">&gt;</span> server<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>So there you have it, creating web servers all through the command line. I hope you’ve enjoyed this psychedelic trip around <code class=" language-undefined">node</code>.</p>
<h2 id="conclusions">Conclusions</h2>
<p>Node.js fits well in modern solutions because it’s simple and lightweight. It takes advantage of modern hardware with its non-blocking design. It embraces the client-server model which is intrinsic to the web. Best of all it runs JavaScript which is the language we love. What I find appealing is the crux of the stack is not so new. The web from its infancy got built around lightweight accessible modules. When you have time, I encourage you to read <a href="http://www.w3.org/DesignIssues/Principles.html">Tim Berners-Lees’ Design Principles</a>. The principle of least power applies to Node.js given the choice to use JavaScript.</p>
<p>I hope you’ve enjoyed this look at the command line tooling, and bid you happy hacking.</p>
  