---
title: "Target=”_blank” — the most underestimated vulnerability ever — Medium"
description: "People using target=’_blank’ links usually have no idea about this curious fact: ¶

The page we’re linking to gains part…"
link: "https://medium.com/@jitbit/target-blank-the-most-underestimated-vulnerability-ever-96e328301f4c#.xjhi71zer"
saved: "2016-05-05 16:23:37"
---
<section name="2792" class=" section--body section--first section--last"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><h3 name="8bb2" id="8bb2" class="graf--h3 graf--first">Target=”_blank” — the most underestimated vulnerability ever</h3><p name="e629" id="e629" class="graf--p graf-after--h3">People using <strong class="markup--strong markup--p-strong">target=’_blank’</strong> links usually have no idea about this curious fact:</p><blockquote name="595a" id="595a" class="graf--blockquote graf-after--p"><em class="markup--em markup--blockquote-em">The page we’re linking to </em><span class="markup--quote markup--blockquote-quote is-other" name="55a87303f1d7 anon_b19bceb20419" data-creator-ids="cb5ee64ea3dc anon">gains partial access to the source page</span><em class="markup--em markup--blockquote-em"> via the </em><strong class="markup--strong markup--blockquote-strong"><em class="markup--em markup--blockquote-em">window.opener</em></strong><em class="markup--em markup--blockquote-em"> object.</em></blockquote><p name="c68c" id="c68c" class="graf--p graf-after--blockquote">The newly opened tab can then change the <strong class="markup--strong markup--p-strong">window.opener.location</strong> to some phishing page. Or execute some JavaScript on the opener-page on your behalf… Users <em class="markup--em markup--p-em">trust</em> the page that is already opened, they won’t get suspicious.</p><figure name="ec49" id="ec49" class="graf--figure graf--layoutOutsetLeft graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*o0iuXWa1JTZ81WEo9mHTgQ.jpeg" data-width="500" data-height="333" data-is-featured="true" data-scroll="native"><img src="https://cdn-images-2.medium.com/freeze/max/30/1*o0iuXWa1JTZ81WEo9mHTgQ.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-2.medium.com/max/600/1*o0iuXWa1JTZ81WEo9mHTgQ.jpeg" src="https://cdn-images-2.medium.com/max/600/1*o0iuXWa1JTZ81WEo9mHTgQ.jpeg"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-2.medium.com/max/600/1*o0iuXWa1JTZ81WEo9mHTgQ.jpeg"&gt;</noscript></div></div></figure><p name="8d03" id="8d03" class="graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Example attack</strong>: create a fake “viral” page with cute cat pictures, jokes or whatever, get it shared on Facebook (which is known for opening links via _blank) and every time someone clicks the link — execute this</p><pre name="42de" id="42de" class="graf--pre graf-after--p">window.opener.location = ‘https://fakewebsite/facebook.com/PHISHING-PAGE.html';</pre><p name="db5a" id="db5a" class="graf--p graf-after--pre">…redirecting to a page that asks the user to re-enter her Facebook password.</p><h4 name="575b" id="575b" class="graf--h4 graf-after--p">How to fix</h4><p name="e91e" id="e91e" class="graf--p graf-after--h4">Add this to your outgoing links.</p><pre name="3da3" id="3da3" class="graf--pre graf-after--p">rel="noopener"</pre><p name="d205" id="d205" class="graf--p graf-after--pre">Update: FF does not support “noopener” so add this.</p><pre name="4f17" id="4f17" class="graf--pre graf-after--p">rel="noopener noreferrer"</pre><p name="18c5" id="18c5" class="graf--p graf-after--pre">Remember, that every time you open a new window via <strong class="markup--strong markup--p-strong">window.open();</strong> you’re also “vulnerable” to this, so always reset the “opener” property</p><pre name="23ab" id="23ab" class="graf--pre graf-after--p">var newWnd = window.open();<br>newWnd.opener = null;</pre><p name="dd23" id="dd23" class="graf--p graf-after--pre">PS. Interestingly, Google <a href="http://ift.tt/1TIyTVv" data-href="http://ift.tt/1TIyTVv" class="markup--anchor markup--p-anchor" rel="nofollow">doesn’t seem to care</a>.</p><p name="dd02" id="dd02" class="graf--p graf-after--p graf--last"><em class="markup--em markup--p-em">Originally published </em><a href="https://www.jitbit.com/alexblog/256-targetblank---the-most-underestimated-vulnerability-ever/" data-href="https://www.jitbit.com/alexblog/256-targetblank---the-most-underestimated-vulnerability-ever/" class="markup--anchor markup--p-anchor" rel="nofollow"><em class="markup--em markup--p-em">on Founder’s blog</em></a></p></div></div></section>